import sys
from Parser import parse_nmap_output, parse_metasploit_output
from ReportGenerator import generate_report

def main(nmap_file, metasploit_file, output_report):
    # Parse Nmap and Metasploit outputs
    print("Parsing Nmap and Metasploit outputs...")
    try:
        nmap_data = parse_nmap_output(nmap_file)
        metasploit_data = parse_metasploit_output(metasploit_file)
    except Exception as e:
        print(f"Error parsing files: {e}")
        sys.exit(1)

    # Generate the report
    try:
        generate_report(nmap_data, metasploit_data, output_report)
        print(f"Report generated successfully: {output_report}")
    except Exception as e:
        print(f"Error generating report: {e}")
        sys.exit(1)

if __name__ == "__main__":
    if len(sys.argv) != 4:
        print("Usage: python Main.py <nmap_output> <metasploit_output> <output_report>")
        sys.exit(1)

    main(sys.argv[1], sys.argv[2], sys.argv[3])
